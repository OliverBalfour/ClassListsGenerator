(this.webpackJsonpcra=this.webpackJsonpcra||[]).push([[0],{102:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(10),i=a.n(r),o=a(20),l=a(68),c=a(69),u=a(77),m=a(76),h=a(155),f=a(104),d=a(4),p=a(21),g=a(131),v=a(134),b=a(135),E=a(136),y=a(137),O=a(138),S=a(161),x=a(162),k=a(73),C=a.n(k);function w(e){var t=Object(g.a)((function(e){return{header:{position:"absolute",top:0,left:0,width:"100%",height:"50px",backgroundColor:e.palette.primary.main,color:"white"},headerLeft:{position:"absolute",top:0,left:0,margin:e.spacing(1),fontFamily:"sans-serif",fontSize:"26px"},headerRight:{position:"absolute",top:0,right:0,padding:6},headerButtonGroup:{marginLeft:e.spacing(1)}}}))(),a=s.a.useState(!1),n=Object(p.a)(a,2),r=n[0],i=n[1],o=s.a.useRef(null),l=function(e){o.current&&o.current.contains(e.target)||i(!r)};return s.a.createElement(h.a,{className:t.header},s.a.createElement(h.a,{className:t.headerLeft},"Class Lists Generator App"),!e.showOptions&&s.a.createElement("a",{href:"https://oliverbalfour.github.io/ClassListsGenerator/docs/instructions.html",style:{color:"white",fontSize:"20px",float:"right",fontFamily:"sans-serif",margin:"14px"},target:"_blank",rel:"noopener noreferrer"},"Instructions"),e.showOptions&&s.a.createElement(h.a,{className:t.headerRight},s.a.createElement(f.a,{onClick:e.viewIssues,color:"default",variant:"contained",style:{marginRight:"10px"}},"View issues (",e.issues.length,")"),"editing"!==e.state&&s.a.createElement(f.a,{onClick:e.restart,color:"default",variant:"contained",style:{marginRight:"10px"}},"Start over"),"editing"!==e.state&&s.a.createElement(f.a,{onClick:function(){return e.toggleState("working")},color:"default",variant:"contained"},"working"===e.state?"Pause":"Play"),s.a.createElement(v.a,{variant:"contained",color:"default",className:t.headerButtonGroup,ref:o},s.a.createElement(f.a,{onClick:function(){return e.toggleState("editing")}},"editing"===e.state?"Done Editing":"Edit"),"editing"!==e.state&&s.a.createElement(f.a,{onClick:e.save},"Save"),"editing"!==e.state&&s.a.createElement(f.a,{size:"small",onClick:function(){return i(!r)}},s.a.createElement(C.a,null))),s.a.createElement(b.a,{open:r,anchorEl:o.current,transition:!0,disablePortal:!0},(function(t){var a=t.TransitionProps,n=t.place;return s.a.createElement(E.a,Object.assign({},a,{style:{transformOrigin:"bottom"===n?"center top":"center bottom"}}),s.a.createElement(y.a,null,s.a.createElement(O.a,{onClickAway:l},s.a.createElement(S.a,{id:"split-button-menu"},s.a.createElement(x.a,{onClick:function(){i(!1),e.import()}},"Import Spreadsheet (CSV)"),s.a.createElement(x.a,{onClick:function(){i(!1),e.export()}},"Export Spreadsheet (CSV)"),s.a.createElement(x.a,{onClick:function(){i(!1),e.openListManager()}},"See Saved Class Lists")))))}))))}var j=a(139),N=a(140),I=a(141),W=a(142),M=a(143),B=a(144),z=a(163),T=a(75),L=a.n(T);function F(e){var t=Object(g.a)((function(e){return{paper:{padding:e.spacing(2),marginTop:"58px",marginRight:e.spacing(1),fontFamily:"sans-serif",width:"320px"},listName:{fontSize:"20px",display:"block",marginBottom:"10px"},className:{margin:0,fontFamily:"sans-serif",fontSize:"20px"},pencil:{float:"right",cursor:"pointer"}}}))(),a=e.list.map((function(t){return e.students[t].categories.map((function(e,t){return e&&0!==t?t:-1})).filter((function(e){return e>=0}))}));return s.a.createElement(j.a,{component:y.a,className:t.paper},s.a.createElement(N.a,{size:"small"},s.a.createElement(I.a,null,s.a.createElement(W.a,null,s.a.createElement(M.a,null,s.a.createElement("h1",{className:t.className},e.name)))),s.a.createElement(B.a,null,e.list.map((function(t){return e.students[t].name})).map((function(n,r){return s.a.createElement(W.a,{key:r},s.a.createElement(M.a,null,n," \xa0\xa0",a[r].map((function(t){return s.a.createElement("span",{key:t},s.a.createElement(z.a,{label:e.categories[t],size:"small"}),"\xa0")})),"editing"!==e.state?null:s.a.createElement(L.a,{className:t.pencil,onClick:function(){return e.editStudent(e.list[r])}})))})))))}function R(e){var t=Object(g.a)((function(e){return{body:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#EEE",margin:0,display:"flex"},columnContainer:{position:"relative",width:"100%",top:0,bottom:0,padding:e.spacing(2),overflowX:"scroll",whiteSpace:"nowrap"},columnBox:{position:"relative",width:"360px",display:"inline-block",margin:e.spacing(1),marginTop:0}}}))();return s.a.createElement(h.a,{className:t.body},s.a.createElement(h.a,{className:t.columnContainer},e.teachers.map((function(a,n){return s.a.createElement(h.a,{className:t.columnBox,key:n},s.a.createElement(F,{name:a,list:e.lists[n],students:e.students,categories:e.categories,state:e.state,editStudent:e.editStudent}))}))))}var U=a(43),J=a(159),P=a(160),_=a(149),G=a(150),V=a(151),A=a(156),D=a(147),X=a(148),$=a(152),q=a(153),H=a(157),K=a(154);function Q(e){var t,a=e.students.map((function(e){return e.name})),n=s.a.useState(JSON.parse(JSON.stringify(e.students[e.student_idx]))),r=Object(p.a)(n,2),i=r[0],l=r[1],c=s.a.useState(""),u=Object(p.a)(c,2),m=u[0],h=u[1],d=s.a.useState({friends:i.friends.map((function(e){return a[e]})).join(", "),mustBeWith:i.mustBeWith.map((function(e){return a[e]})).join(", "),cannotBeWith:i.cannotBeWith.map((function(t){return e.students[t].name})).join(", ")}),g=Object(p.a)(d,2),v=g[0],b=g[1],E=function(e){return function(t){return b(Object(o.a)(Object(o.a)({},v),{},Object(U.a)({},e,t.target.value)))}},y=s.a.useState(e.classIdx),O=Object(p.a)(y,2),S=O[0],x=O[1],k=function(t){for(var n={},s=!1,r=0,i=Object.entries(v);r<i.length;r++){var o=Object(p.a)(i[r],2),c=o[0],u=o[1];n[c]=""===u?[]:u.split(",").map((function(e){return a.indexOf(e.trim())}));var m=n[c].indexOf(-1);-1!==m&&(s=u.split(",")[m])}if(0===t.possibleTeachers.length)h("Cannot have zero possible teachers.");else if(!1!==s)h("Invalid name: '"+s+"'. Make sure spelling is exact and there is one comma between each name.");else{for(var f=0,d=Object.entries(n);f<d.length;f++){var g=Object(p.a)(d[f],2),b=g[0],E=g[1];t[b]=E}l(t),S!==e.classIdx&&t!==e.students[e.student_idx]&&e.updateStudentClassIdx(S),e.updateStudent(t)}},C=s.a.createElement(s.a.Fragment,null,s.a.createElement(J.a,{label:"Must be with (comma separated names)",variant:"filled",value:v.mustBeWith,onChange:E("mustBeWith"),fullWidth:!0}),s.a.createElement(J.a,{label:"Cannot be with (comma separated names)",variant:"filled",value:v.cannotBeWith,onChange:E("cannotBeWith"),fullWidth:!0}),s.a.createElement(J.a,{label:"Friends (comma separated names)",variant:"filled",value:v.friends,onChange:E("friends"),fullWidth:!0}));return s.a.createElement(P.a,{open:!0,onClose:function(){},"aria-labelledby":"form-dialog-title"},s.a.createElement(_.a,{id:"form-dialog-title"},"Editing ",i.name),s.a.createElement(G.a,null,s.a.createElement(V.a,null,"To force a class change after lists are generated, you must edit a student's parameters.\xa0",0===m.length?null:s.a.createElement("span",{style:{color:"red"}},"Error: ",m)),s.a.createElement(J.a,{label:"Name",variant:"filled",value:i.name,onChange:(t="name",function(e){return l(Object(o.a)(Object(o.a)({},i),{},Object(U.a)({},t,e.target.value.trim())))}),fullWidth:!0}),s.a.createElement(A.a,{native:!0,value:e.teachers[S],onChange:function(t){return x(e.teachers.indexOf(t.target.value))},fullWidth:!0},e.teachers.map((function(e,t){return s.a.createElement("option",{value:e,key:t},e)}))),s.a.createElement(D.a,{component:"fieldset",style:{marginTop:"20px"}},s.a.createElement(X.a,{component:"legend"},"Categories"),s.a.createElement($.a,null,i.categories.map((function(t,a){return s.a.createElement(q.a,{control:s.a.createElement(H.a,{checked:t,onChange:function(){i.categories[a]=!i.categories[a],l(Object(o.a)({},i))}}),label:e.categories[a],key:a})})))),s.a.createElement(D.a,{component:"fieldset",style:{marginTop:"20px"}},s.a.createElement(X.a,{component:"legend"},"Possible teachers"),s.a.createElement($.a,null,e.teachers.map((function(e,t){return s.a.createElement(q.a,{control:s.a.createElement(H.a,{checked:-1!==i.possibleTeachers.indexOf(t),onChange:function(){var e=i.possibleTeachers.indexOf(t);-1===e?i.possibleTeachers.push(t):i.possibleTeachers.splice(e,1),l(Object(o.a)({},i))}}),label:e,key:t})})))),C),s.a.createElement(K.a,null,s.a.createElement(f.a,{color:"primary",onClick:function(){return k(e.students[e.student_idx])}},"Cancel"),s.a.createElement(f.a,{onClick:function(){return k(i)},color:"primary"},"Update")))}function Y(e){return s.a.createElement(P.a,{open:!0,onClose:function(){},"aria-labelledby":"form-dialog-title",fullWidth:!0,maxWidth:"md"},s.a.createElement(_.a,{id:"form-dialog-title"},"Issues with current class list"),s.a.createElement(G.a,null,s.a.createElement(N.a,{size:"small"},s.a.createElement(B.a,null,e.issues.map((function(e,t){return s.a.createElement(W.a,{key:t},s.a.createElement(M.a,null,e.message))}))))),s.a.createElement(K.a,null,s.a.createElement(f.a,{color:"primary",onClick:e.close},"Close")))}var Z=a(41),ee=a(30);function te(e,t,a){if(e=ne(e),ae(0,2)<1){var n=ae(0,t.length),s=ae(0,t.length-1);s===n&&(s=t.length-1);var r=ie(e,n),i=ie(e,s);e[r][e[r].indexOf(n)]=s,e[i][e[i].indexOf(s)]=n}else{var o=ae(0,t.length),l=ae(0,e.length-1),c=ie(e,o);l===c&&(l=e.length-1),e[c].splice(e[c].indexOf(o),1),e[l].push(o)}var u,m={},h=Object(ee.a)(e);try{for(h.s();!(u=h.n()).done;){var f,d=u.value,p=Object(ee.a)(d);try{for(p.s();!(f=p.n()).done;){var g=f.value;m[g]?console.error("Duplicated student"):m[g]=!0}}catch(v){p.e(v)}finally{p.f()}}}catch(v){h.e(v)}finally{h.f()}return e}var ae=function(e,t){return Math.floor(Math.random()*(t-e)+e)},ne=function(e){return JSON.parse(JSON.stringify(e))},se=function(e){return Math.min(0,e)};function re(e,t,a,n,s){return oe(e,t,a,n,s).map((function(e){return e.severity})).reduce((function(e,t){return e+t}),0)}var ie=function(e,t){return e.map((function(e){return-1!==e.indexOf(t)})).indexOf(!0)};function oe(e,t,a,n,s){for(var r=[],i=0;i<e.length;i++){for(var o=e[i],l=0;l<o.length;l++){var c,u=t[o[l]],m=Object(ee.a)(u.mustBeWith);try{for(m.s();!(c=m.n()).done;){var h=c.value;-1===o.indexOf(h)&&r.push({severity:3,message:"".concat(u.name," must be with ").concat(t[h].name,".")})}}catch(C){m.e(C)}finally{m.f()}var f,d=Object(ee.a)(u.cannotBeWith);try{for(d.s();!(f=d.n()).done;){var p=f.value;-1!==o.indexOf(p)&&r.push({severity:5,message:"".concat(u.name," cannot be with ").concat(t[p].name,".")})}}catch(C){d.e(C)}finally{d.f()}var g,v=0,b=Object(ee.a)(u.friends);try{for(b.s();!(g=b.n()).done;){var E=g.value;-1!==o.indexOf(E)&&v++}}catch(C){b.e(C)}finally{b.f()}v<1&&r.push({severity:3,message:"".concat(u.name," is not with any friends.")}),-1===u.possibleTeachers.indexOf(i)&&r.push({severity:5,message:"".concat(u.name," must not be in ").concat(s[i],"'s class.")})}if(o.length<a[0]){var y=a[0]-o.length;r.push({severity:8*y,message:"".concat(s[i],"'s class has ").concat(y," too few students.")})}else if(o.length>a[1]){var O=o.length-a[1];r.push({severity:10*O,message:"".concat(s[i],"'s class has ").concat(O," too many students.")})}}for(var S=n.map((function(a,n){return e.map((function(e){return e.map((function(e){return t[e].categories[n]})).reduce((function(e,t){return e+t}),0)}))})),x=0;x<n.length;x++){var k=Math.max.apply(Math,Object(Z.a)(S[x]))-Math.min.apply(Math,Object(Z.a)(S[x]));(k>1&&0!==x||k>3&&0===x)&&r.push({severity:k,message:"Imbalanced ".concat(n[x]," category: ").concat(S[x]," students per class respectively.")})}return r}function le(e,t){for(var a=function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}(e.map((function(e,t){return t}))),n=[],s=0,r=Math.ceil(e.length/t),i=0;i<t;i++)n.push(a.slice(s,s+r)),s+=r;return n}var ce=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={teacherNames:[],lists:[],state:"view",editingStudent:-1,issues:[],viMod:!1},e.numUselessIterations=0,e}return Object(c.a)(a,[{key:"import",value:function(){var e=this;fetch("./dummy.csv").then((function(t){if(200!==t.status)return console.error(t.status);t.text().then((function(t){var a=function(e){for(var t=e.split(/[\r\n]+/);-1!==t.indexOf("");)t.splice(t.indexOf(""),1);for(var a=function(e){var t,a=!1,n=[],s="",r=Object(ee.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;'"'!==i?a||","!==i?s+=i:(n.push(s.trim()),s=""):a=!a}}catch(o){r.e(o)}finally{r.f()}return n.push(s.trim()),n},n=parseInt(t[1].split(",")[5]),s=parseInt(t[1].split(",")[1]),r=parseInt(t[1].split(",")[2]),i=a(t[1]).slice(8).filter((function(e){return e.length>0})),o=["Female"].concat(Object(Z.a)(a(t[5]).slice(10))),l=[],c=t.slice(6).map((function(e){return e.substring(0,e.indexOf(","))})),u=6;u<t.length;u++){var m=a(t[u]);m.length<10&&console.log("Is there a / at the end of the URL?"),l.push({name:m[0],categories:["F"===m[1]].concat(Object(Z.a)(m.slice(10).map((function(e){return e.length>0})))),friends:m.slice(2,7).map((function(e){return c.indexOf(e)})).filter((function(e){return e>=0})),mustBeWith:0===m[8].length?[]:a(m[8]).map((function(e){return c.indexOf(e)})).filter((function(e){return e>=0})),cannotBeWith:0===m[7].length?[]:a(m[7]).map((function(e){return c.indexOf(e)})).filter((function(e){return e>=0})),possibleTeachers:"all"===m[9].toLowerCase()||"any"===m[9].toLowerCase()||""===m[9]?i.map((function(e,t){return t})):a(m[9]).map((function(e){return i.indexOf(e)})).filter((function(e){return e>=0}))})}return{numClasses:n,classSize:[s,r],teacherNames:i,categories:o,students:l,studentNames:c}}(t),n=le(a.studentNames,a.numClasses),s=oe(n,a.students,a.classSize,a.categories,a.teacherNames);e.setState(Object(o.a)(Object(o.a)({},a),{},{lists:n,issues:s}))}))})).catch(console.log)}},{key:"toggleState",value:function(e){"working"===e&&"working"!==this.state.state?this.startWorking():this.stopWorking(),this.state.state!==e?this.setState({state:e}):this.setState({state:"import"})}},{key:"startWorking",value:function(){this.worker(),this.intev=setInterval(this.worker.bind(this),500)}},{key:"worker",value:function(){var e=function(e,t,a,n,s){for(var r=0,i=0;r<100&&i<5;r++){for(var o=se(r/100-i/5),l=Math.round(1+4*o),c=.05*o,u=ne(e),m=0;m<l;m++)u=te(u,t,a);(Math.random()<c||re(u,t,a,n,s)<re(e,t,a,n,s))&&(i++,e=u)}return{lists:e,issues:oe(e,t,a,n,s)}}(this.state.lists,this.state.students,this.state.classSize,this.state.categories,this.state.teacherNames),t=e.lists,a=e.issues;this.state.issues.length===a.length?this.numUselessIterations++:this.numUselessIterations=0,(this.numUselessIterations>=5||0===a.length)&&(this.toggleState("working"),this.numUselessIterations=0),this.setState({lists:t,issues:a})}},{key:"stopWorking",value:function(){clearInterval(this.intev)}},{key:"editStudent",value:function(e){this.setState({editingStudent:e})}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state.lists.map((function(t){return-1!==t.indexOf(e.state.editingStudent)})).indexOf(!0);return s.a.createElement(h.a,{className:t.root},this.state.teacherNames.length?s.a.createElement(R,{teachers:this.state.teacherNames,students:this.state.students,categories:this.state.categories,lists:this.state.lists,state:this.state.state,editStudent:this.editStudent.bind(this)}):s.a.createElement(h.a,{className:t.fallback},"Please \xa0",s.a.createElement(f.a,{onClick:this.import.bind(this),size:"large",color:"primary",variant:"contained"},"import"),"\xa0 a spreadsheet"),s.a.createElement(w,{import:this.import.bind(this),export:function(){},openListManager:function(){},toggleState:this.toggleState.bind(this),save:function(){},restart:function(){return e.setState({lists:le(e.state.studentNames,e.state.numClasses)})},state:this.state.state,showOptions:this.state.teacherNames.length>0,issues:this.state.issues,viewIssues:function(){return e.setState({viMod:!e.state.viMod})}}),this.state.editingStudent<0?null:s.a.createElement(Q,{student_idx:this.state.editingStudent,teachers:this.state.teacherNames,students:this.state.students,categories:this.state.categories,updateStudent:function(t){var a=e.state.students;a[e.state.editingStudent]=t,e.setState({students:a,editingStudent:-1,issues:oe(e.state.lists,a,e.state.classSize,e.state.categories,e.state.teacherNames)})},classIdx:a,updateStudentClassIdx:function(t){e.state.lists[a].splice(e.state.lists[a].indexOf(e.state.editingStudent),1),e.state.lists[t].push(e.state.editingStudent),e.setState({lists:e.state.lists})}}),this.state.viMod?s.a.createElement(Y,{issues:this.state.issues,close:function(){return e.setState({viMod:!e.state.viMod})}}):null)}}]),a}(s.a.Component),ue=Object(d.a)((function(e){return{root:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#EEE"},fallback:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",fontFamily:"sans-serif",fontSize:"30px"}}}))(ce);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},92:function(e,t,a){e.exports=a(102)}},[[92,1,2]]]);
//# sourceMappingURL=main.aa1818ba.chunk.js.map